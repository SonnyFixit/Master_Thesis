import pandas as pd
import os

# Ścieżki do plików
classification_file = r"C:\GitRepositories\Master_Thesis\FM_QualityClassification\FM_QualityClassification_Binary_Updated.csv"
segment_info_file = r"C:\GitRepositories\Master_Thesis\FM_QualityClassification\IMU_Segmented_Group_Info_Augmented.csv"

# Ścieżka do zapisu nowego pliku na pulpit
output_file = os.path.join(os.path.expanduser('~'), 'Desktop', 'Expanded_IMU_Segmented_Data.csv')

# Wczytanie danych z plików CSV
df_classification = pd.read_csv(classification_file)
df_segment_info = pd.read_csv(segment_info_file)

# Nowa lista dla rozwiniętych próbek
expanded_data = []
current_segment_id = 1  # Zaczynamy od Segment ID = 1

# Iteracja po każdym wierszu segment_info, aby rozwijać próbki
for _, row in df_segment_info.iterrows():
    child_id = row['Child ID']
    classification = row['Classification']
    augmented = row['Augmented']
    start_row = row['Start Row']
    end_row = row['End Row']
    
    # Obliczanie liczby próbek na podstawie zakresu (Start Row -> End Row)
    num_samples = end_row - start_row + 1
    
    # Generowanie wierszy dla każdej próbki w zakresie Start Row -> End Row z unikalnym Segment ID
    for segment_id in range(num_samples):
        expanded_data.append({
            'Segment ID': current_segment_id,  # Unikalne Segment ID
            'Child ID': child_id,
            'Classification': classification,
            'Augmented': augmented
        })
        current_segment_id += 1  # Zwiększamy numer Segment ID dla każdej próbki

# Przekształcenie listy w DataFrame
expanded_df = pd.DataFrame(expanded_data)

# Zmiana kolejności kolumn
expanded_df = expanded_df[['Segment ID', 'Child ID', 'Classification', 'Augmented']]

# Zapis do pliku CSV na pulpicie
expanded_df.to_csv(output_file, index=False)

print(f"Przetwarzanie zakończone. Plik został zapisany na pulpicie jako: {output_file}")
